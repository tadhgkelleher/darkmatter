<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galaxy in Brane-World Gravity with Dark Matter</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
            color: #333;
        }
        h1, h2 {
            text-align: center;
        }
        #visualization {
            display: block;
            margin: 0 auto;
            border: 2px solid #333;
            background-color: #000;
        }
        #controls {
            text-align: center;
            margin-top: 20px;
        }
        button, input, label {
            margin: 5px;
            padding: 10px;
            font-size: 16px;
        }
        .mathjax {
            max-width: 800px;
            margin: 10px auto;
            line-height: 1.6;
        }
        p {
            max-width: 800px;
            margin: 10px auto;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <h1>Galaxy in Brane-World Gravity with Dark Matter</h1>
    <canvas id="visualization" width="800" height="600"></canvas>
    <div id="controls">
        <button onclick="toggleDarkMatter()">Toggle Dark Matter Halo</button>
        <label for="kkModes">KK Modes (n): </label>
        <input type="range" id="kkModes" min="1" max="5" step="1" value="3">
        <label for="compactLength">Compactification Length (L): </label>
        <input type="range" id="compactLength" min="1" max="10" step="1" value="5">
        <label for="weylStrength">Weyl Tensor Strength: </label>
        <input type="range" id="weylStrength" min="0.1" max="2" step="0.1" value="1">
    </div>
    <h2>Mathematical Framework</h2>
    <div class="mathjax">
        <p>5D Einstein Equations: \( G_{AB}^{(5)} = \kappa_5^2 \left[ T_{AB}^{(\text{bulk})} + \delta(y) T_{\mu\nu}^{(\text{brane})} \right] \)</p>
        <p>Dark Matter Scalar Field: \( \phi(x^\mu, y) = \sum_{n=0}^\infty \phi_n(x^\mu) \cos\left(\frac{n\pi y}{L}\right) \)</p>
        <p>Induced 4D Gravity: \( G_{\mu\nu}^{(4)} = 8\pi G_N T_{\mu\nu}^{(\text{vis})} + \kappa_5^4 \Pi_{\mu\nu} - E_{\mu\nu} \)</p>
    </div>
    <h2>Explanation</h2>
    <p>
        This visualization depicts a spiral galaxy as a 4D brane (blue disk with white stars) at \( y = 0 \) in a 5D bulk (gray grid). The green pulsating halo represents the dark matter scalar field \( \phi(x^\mu, y) \), computed with Kaluza-Klein modes, influencing the galaxy via the Weyl tensor \( E_{\mu\nu} \) (red perturbations). Adjust the number of KK modes, compactification length \( L \), and Weyl tensor strength to explore their effects.
    </p>

    <script>
        const canvas = document.getElementById('visualization');
        const ctx = canvas.getContext('2d');
        let showDarkMatter = true;
        let kkModes = 3;
        let compactLength = 5;
        let weylStrength = 1;
        let time = 0;

        // Galaxy star positions
        const stars = [];
        for (let i = 0; i < 200; i++) {
            let r = Math.random() * 200;
            let theta = Math.random() * 2 * Math.PI;
            let arm = Math.floor(Math.random() * 2) * Math.PI; // Two spiral arms
            theta += 0.5 * r + arm; // Spiral structure
            stars.push({ r, theta });
        }

        function toggleDarkMatter() {
            showDarkMatter = !showDarkMatter;
            draw();
        }

        document.getElementById('kkModes').addEventListener('input', (e) => {
            kkModes = parseInt(e.target.value);
            draw();
        });

        document.getElementById('compactLength').addEventListener('input', (e) => {
            compactLength = parseFloat(e.target.value);
            draw();
        });

        document.getElementById('weylStrength').addEventListener('input', (e) => {
            weylStrength = parseFloat(e.target.value);
            draw();
        });

        function drawBulk() {
            ctx.strokeStyle = '#555';
            ctx.lineWidth = 1;
            // Draw 5D bulk as a grid
            for (let x = 0; x <= canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y <= canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
            ctx.fillStyle = '#fff';
            ctx.font = '16px Arial';
            ctx.fillText('5D Bulk, y ∈ [0, L]', 10, 30);
        }

        function drawGalaxy() {
            // Draw galactic disk (4D brane)
            ctx.fillStyle = 'rgba(0, 0, 255, 0.2)';
            ctx.beginPath();
            ctx.arc(400, 300, 200, 0, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = '#00f';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = '#fff';
            ctx.fillText('4D Brane (Galaxy, y = 0)', 350, 280);

            // Draw stars
            ctx.fillStyle = '#fff';
            stars.forEach(star => {
                let x = 400 + star.r * Math.cos(star.theta + time * 0.05);
                let y = 300 + star.r * Math.sin(star.theta + time * 0.05);
                ctx.beginPath();
                ctx.arc(x, y, 2, 0, 2 * Math.PI);
                ctx.fill();
            });
        }

        function drawDarkMatterHalo() {
            if (!showDarkMatter) return;
            ctx.strokeStyle = '#0f0';
            ctx.lineWidth = 2;
            // Draw concentric halos influenced by KK modes
            for (let r = 220; r <= 300; r += 20) {
                ctx.beginPath();
                for (let theta = 0; theta <= 2 * Math.PI; theta += 0.1) {
                    let x = 400 + r * Math.cos(theta);
                    let y = 300 + r * Math.sin(theta);
                    let phi = 0;
                    // Compute scalar field with KK modes
                    for (let n = 1; n <= kkModes; n++) {
                        let phi_n = 10 / n * Math.sin((r * 0.02 + time) * Math.PI);
                        let y_comp = Math.cos(n * Math.PI * ((y - 300) / 200) / compactLength);
                        phi += phi_n * y_comp;
                    }
                    x += phi * Math.cos(theta);
                    y += phi * Math.sin(theta);
                    if (theta === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.closePath();
                ctx.stroke();
            }
            ctx.fillStyle = '#0f0';
            ctx.fillText('Dark Matter Halo φ(xᵝ, y)', 350, 80);
        }

        function drawGravitationalEffects() {
            // Simulate Weyl tensor perturbations on galaxy
            ctx.strokeStyle = '#f00';
            ctx.lineWidth = 2;
            for (let theta = 0; theta < 2 * Math.PI; theta += Math.PI / 4) {
                let amplitude = 0;
                for (let n = 1; n <= kkModes; n++) {
                    amplitude += weylStrength * 10 / n * Math.sin((200 * 0.02 + time) * Math.PI);
                }
                let x1 = 400 + 180 * Math.cos(theta);
                let y1 = 300 + 180 * Math.sin(theta);
                let x2 = 400 + (180 + amplitude) * Math.cos(theta);
                let y2 = 300 + (180 + amplitude) * Math.sin(theta);
                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.stroke();
            }
            ctx.fillStyle = '#f00';
            ctx.fillText('Weyl Tensor Eᵢᵥ', 350, 520);
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBulk();
            drawGalaxy();
            drawDarkMatterHalo();
            drawGravitationalEffects();
        }

        function animate() {
            time += 0.05;
            draw();
            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
